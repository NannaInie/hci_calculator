<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Carbon Footprint Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f4f4f4;
        }

        .calculator-container {
            width: 90%;
            max-width: 600px;
            background-color: white;
            border: 1px solid #ccc;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        input, select {
            width: calc(100% - 20px);
            padding: 8px;
            margin: 5px 0 10px 0;
            border: 1px solid #ccc;
            border-radius: 4px;
        }

        button {
            padding: 10px 20px;
            background-color: #007BFF;
            border: none;
            border-radius: 4px;
            color: white;
            font-weight: bold;
            cursor: pointer;
        }

        button:hover {
            background-color: #0056b3;
        }

        #jobs-list {
            margin-top: 20px;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            background-color: #f9f9f9;
        }

        .job-item {
            margin-bottom: 10px;
            padding: 10px;
            background-color: #e9ecef;
            border-radius: 4px;
        }

        #result {
            margin-top: 20px;
            padding: 15px;
            border: 2px solid #28a745;
            border-radius: 4px;
            background-color: #d4edda;
            color: #155724;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="calculator-container">
        <h1>Carbon Footprint Calculator</h1>

        <div class="form-group">
            <label for="use-case">Select Use Case:</label>
            <select id="use-case" required>
                <option value="research-planning">Research & Planning</option>
                <option value="prototyping-building">Prototyping & Building</option>
                <option value="evaluation-user-studies">Evaluation & User Studies</option>
                <option value="data-collection">Data Collection</option>
                <option value="analysis-synthesis">Analysis & Synthesis</option>
                <option value="dissemination-communication">Dissemination & Communication</option>
                <option value="training-fine-tuning">Training & Fine-tuning</option>
            </select>
        </div>

        <div class="form-group">
            <label for="specific-task">Select Specific Task:</label>
            <select id="specific-task" required>
                <!-- Task options will be dynamically populated -->
            </select>
        </div>

        <div id="dynamic-parameters"></div>

        <div class="form-group">
            <label for="training-time">Training Time (in hours):</label>
            <div style="display: flex; align-items: center; gap: 10px;">
                <span id="min-training-time">1</span>
                <input type="range" id="training-time" min="1" max="100" value="1" step="1" required style="flex-grow: 1;">
                <span id="training-time-display">1</span> hours
                <span id="max-training-time">100</span>
            </div>
        </div>

        <div class="form-group">
            <label for="carbon-intensity">Carbon Intensity (kgCO2e/kWh):</label>
            <input type="number" id="carbon-intensity" min="0" step="0.01" value="0.45" required>
        </div>

        <div class="form-group">
            <label for="power-usage">Power Usage Effectiveness (PUE):</label>
            <input type="number" id="power-usage" min="1" step="0.01" value="1.58" required>
        </div>

        <button id="add-job">Add Job</button>
        <button id="calculate">Calculate Total Carbon Footprint</button>

        <div id="jobs-list"></div>
        <div id="result"></div>
    </div>
    <script>
        const jobs = [];

        const taskParameters = {
            "literature-review": [
                { id: "num-papers", label: "Number of Papers Reviewed", type: "number", min: 1 },
                { id: "search-databases", label: "Number of Databases Used", type: "number", min: 1 }
            ],
            "goal-definition": [
                { id: "num-meetings", label: "Number of Team Meetings", type: "number", min: 1 },
                { id: "duration-per-meeting", label: "Average Meeting Duration (hours)", type: "number", min: 0.5, step: 0.1 }
            ],
            "language-model-fine-tuning": [
                { id: "num-epochs", label: "Number of Epochs", type: "number", min: 1 },
                { id: "dataset-size", label: "Dataset Size (GB)", type: "number", min: 0.1, step: 0.1 }
            ],
            "custom-dataset-training": [
                { id: "num-layers", label: "Number of Layers in the Model", type: "number", min: 1 },
                { id: "training-batch-size", label: "Training Batch Size", type: "number", min: 1 }
            ]
        };

        function populateDynamicParameters(task) {
            const dynamicParamsDiv = document.getElementById('dynamic-parameters');
            dynamicParamsDiv.innerHTML = ''; // Clear previous parameters

            const parameters = taskParameters[task] || [];
            parameters.forEach(param => {
                const paramDiv = document.createElement('div');
                paramDiv.classList.add('form-group');

                const label = document.createElement('label');
                label.htmlFor = param.id;
                label.textContent = param.label;

                const input = document.createElement('input');
                input.id = param.id;
                input.type = param.type;
                input.min = param.min;
                if (param.step) input.step = param.step;

                paramDiv.appendChild(label);
                paramDiv.appendChild(input);
                dynamicParamsDiv.appendChild(paramDiv);
            });
        }

        document.getElementById('training-time').addEventListener('input', function () {
            document.getElementById('training-time-display').textContent = this.value;
        });

        document.getElementById('specific-task').addEventListener('change', function () {
            populateDynamicParameters(this.value);
        });

	document.getElementById('use-case').addEventListener('change', function () {
	    populateSpecificTasks(this.value);
	});

	function populateSpecificTasks(useCase) {
	    const specificTaskSelect = document.getElementById('specific-task');
	    specificTaskSelect.innerHTML = ''; // Clear old options

	    let tasks = [];
	    switch (useCase) {
		case "research-planning":
		    tasks = ["literature-review", "goal-definition"];
		    break;
		case "training-fine-tuning":
		    tasks = ["language-model-fine-tuning", "custom-dataset-training"];
		    break;
		// Add more cases for other use cases
	    }

	    tasks.forEach(task => {
		const option = document.createElement('option');
		option.value = task;
		option.textContent = task.replace(/-/g, ' ').replace(/\b\w/g, c => c.toUpperCase());
		specificTaskSelect.appendChild(option);
	    });

	    specificTaskSelect.dispatchEvent(new Event('change')); // Trigger task parameter population
	}

	// Initialize the dropdown on page load
	document.addEventListener('DOMContentLoaded', function () {
	    const initialUseCase = document.getElementById('use-case').value;
	    populateSpecificTasks(initialUseCase);
	});

        document.getElementById('add-job').addEventListener('click', function () {
            const useCase = document.getElementById('use-case').value;
            const specificTask = document.getElementById('specific-task').value;
            const trainingTime = parseFloat(document.getElementById('training-time').value);
            const carbonIntensity = parseFloat(document.getElementById('carbon-intensity').value);
            const powerUsage = parseFloat(document.getElementById('power-usage').value);

            const job = {
                useCase,
                specificTask,
                trainingTime,
                carbonIntensity,
                powerUsage,
                parameters: []
            };

            const dynamicParams = document.querySelectorAll('#dynamic-parameters input');
            dynamicParams.forEach(input => {
                job.parameters.push({ id: input.id, value: parseFloat(input.value) });
            });

            jobs.push(job);

            const jobItem = document.createElement('div');
            jobItem.classList.add('job-item');
            jobItem.textContent = `Use Case: ${useCase}, Task: ${specificTask}, Training Time: ${trainingTime} hours`;
            document.getElementById('jobs-list').appendChild(jobItem);
        });

        document.getElementById('calculate').addEventListener('click', function () {
            let totalFootprint = 0;

            jobs.forEach(job => {
                const energyUsage = job.trainingTime * job.powerUsage;
                const carbonFootprint = energyUsage * job.carbonIntensity;
                totalFootprint += carbonFootprint;
            });

            const resultDiv = document.getElementById('result');
            resultDiv.textContent = `Total Carbon Footprint: ${totalFootprint.toFixed(2)} kgCO2e`;
        });
    </script>
</body>
</html>

